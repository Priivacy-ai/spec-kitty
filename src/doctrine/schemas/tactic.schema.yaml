$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "https://spec-kitty.dev/schemas/doctrine/tactic.schema.yaml"
title: Tactic
description: Minimal schema for reusable behavior tactics.
type: object
additionalProperties: false
required:
  - schema_version
  - id
  - name
  - steps
definitions:
  reference:
    type: object
    additionalProperties: false
    required:
      - name
      - type
      - id
      - when
    properties:
      name:
        type: string
        minLength: 1
        description: Human-readable name of the referenced artifact.
      type:
        type: string
        enum:
          - styleguide
          - tactic
          - directive
          - toolguide
        description: Doctrine artifact type being referenced.
      id:
        type: string
        pattern: '^[A-Za-z][A-Za-z0-9_-]*$'
        description: Artifact identifier matching the id field of the referenced artifact.
      when:
        type: string
        minLength: 1
        description: When this reference should be consulted during the step or tactic.
properties:
  schema_version:
    type: string
    pattern: '^1\.0$'
  id:
    type: string
    pattern: '^[a-z][a-z0-9-]*$'
  name:
    type: string
    minLength: 1
  purpose:
    type: string
  references:
    type: array
    minItems: 1
    items:
      $ref: '#/definitions/reference'
  steps:
    type: array
    minItems: 1
    items:
      type: object
      additionalProperties: false
      required:
        - title
      properties:
        title:
          type: string
          minLength: 1
        description:
          type: string
          minLength: 1
        examples:
          type: array
          minItems: 1
          items:
            type: string
            minLength: 1
        references:
          type: array
          minItems: 1
          items:
            $ref: '#/definitions/reference'
